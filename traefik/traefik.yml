# Traefik Static Configuration
# This file contains the static configuration that doesn't change at runtime
#
# Migration Notes:
#   - Migrated from nginx to Traefik for better Docker integration
#   - Traefik automatically discovers containers via Docker labels
#   - Dynamic routing configuration is in ./dynamic/ directory
#   - SSL/TLS certificates are managed automatically via Let's Encrypt
#   - Dashboard is enabled for development (disable in production)
#
# Key Features:
#   - Automatic service discovery from Docker labels
#   - HTTP (port 80) and HTTPS (port 443) entry points
#   - Let's Encrypt SSL certificate automation
#   - File-based dynamic configuration for custom routes
#   - Access logging enabled
#
# Production Checklist:
#   - [ ] Set api.insecure to false
#   - [ ] Add authentication to dashboard
#   - [ ] Update email address for Let's Encrypt
#   - [ ] Ensure acme.json has proper permissions (600)
#   - [ ] Configure firewall rules for ports 80/443

api:
  dashboard: true
  insecure: true  # Set to false in production and use authentication
  debug: false

entryPoints:
  web:
    address: ":80"
    # Note: Redirect to HTTPS is handled per-router, not globally
    # This allows .local domains to work over HTTP
  websecure:
    address: ":443"

providers:
  docker:
    endpoint: "unix:///var/run/docker.sock"
    exposedByDefault: false
    network: stackyn-network
  file:
    directory: /etc/traefik/dynamic
    watch: true

certificatesResolvers:
  letsencrypt:
    acme:
      email: admin@stackyn.com  # Change this to your email
      storage: /etc/traefik/acme/acme.json
      httpChallenge:
        entryPoint: web
      # Optional: Use Let's Encrypt staging for testing (remove in production)
      # caServer: https://acme-staging-v02.api.letsencrypt.org/directory
      # Enable certificate persistence and automatic renewal
      keyType: "EC256"

log:
  level: INFO

accessLog: {}

